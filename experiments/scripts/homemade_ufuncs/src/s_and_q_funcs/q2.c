#include <math.h>
#include "chbevl.h"

/* Starting with
 *	 q_2(x) = int_{0.5}^x K_1(u)/u^6 du
 * function. */

/* coeffs for q_2(x) with 0.5 < x < 1.0 */
static double q_2_A[] = 
  {
    -1.566917891733984e-15,
    -1.258888826516369e-15,
    4.223126478149671e-15,
    -1.080755855179897e-14,
    3.070772802704624e-14,
    -1.360563282408004e-13,
    6.546181421004013e-13,
    -3.129937512872753e-12,
    1.486775471256270e-11,
    -6.996951282256525e-11,
    3.262309855126914e-10,
    -1.505069985539379e-09,
    6.864105480073694e-09,
    -3.090859509840190e-08,
    1.372250496255167e-07,
    -5.996980045087918e-07,
    2.574723452862526e-06,
    -1.083463306385003e-05,
    4.456116193784545e-05,
    -1.785057833317287e-04,
    6.934697305652548e-04,
    -2.598416386639460e-03,
    9.324593318561124e-03,
    -3.174945460764968e-02,
    1.012777178506477e-01,
    -2.973076428672533e-01,
    7.824121561978455e-01,
    -1.772638129906195e+00,
    3.234178878058354e+00,
    1.246483542368269e+01,
  };
/* coeffs for q_2(x) with 1.0 < x < 5.0 */
static double q_2_B[] = 
  {
    1.271482918951961e-13,
    -3.459066366673369e-13,
    8.115674798858663e-13,
    -1.871902632899491e-12,
    4.329003822078903e-12,
    -9.917155985306181e-12,
    2.263553788850459e-11,
    -5.149471959953189e-11,
    1.166418073239583e-10,
    -2.630982098850154e-10,
    5.906074296291308e-10,
    -1.319427189727662e-09,
    2.932260212418214e-09,
    -6.480355763116563e-09,
    1.423660886956668e-08,
    -3.107696873172472e-08,
    6.737318303251527e-08,
    -1.449842963463510e-07,
    3.095148958909277e-07,
    -6.550562549723083e-07,
    1.373361464818146e-06,
    -2.849901582724357e-06,
    5.847797248126340e-06,
    -1.185197465121135e-05,
    2.369583791983487e-05,
    -4.666570550830862e-05,
    9.037049793869656e-05,
    -1.717485536649743e-04,
    3.195809967468932e-04,
    -5.806183952276722e-04,
    1.026596347662023e-03,
    -1.759595833188943e-03,
    2.910094104534977e-03,
    -4.618145686277053e-03,
    6.986010802326170e-03,
    -9.996254710278674e-03,
    1.341136316562981e-02,
    -1.671153009086019e-02,
    1.916294789091806e-02,
    1.666741313326904e+01,
  };
/* coeffs for q_2(x) with 5.0 < x < 30.0 */
static double q_2_C[] = 
  {
    6.904106915802307e-14,
    -1.711741859367066e-13,
    3.556858511425768e-13,
    -6.692128332967211e-13,
    1.250288761411866e-12,
    -2.313201482214330e-12,
    4.269207209972592e-12,
    -7.771028265324275e-12,
    1.396402993236734e-11,
    -2.476128931524120e-11,
    4.329786899385605e-11,
    -7.451781414147263e-11,
    1.261112695753278e-10,
    -2.096552265129503e-10,
    3.418299717357816e-10,
    -5.459125892078494e-10,
    8.526382562952980e-10,
    -1.300397478587456e-09,
    1.933558557709603e-09,
    -2.798306653062355e-09,
    3.935278769517936e-09,
    -5.368847884786494e-09,
    7.094303515013205e-09,
    -9.065450612411041e-09,
    1.118640102030592e-08,
    -1.331200737790065e-08,
    1.526001132864015e-08,
    -1.683530956123983e-08,
    1.786255433936882e-08,
    1.668748970067161e+01,
  };

double q2(double x)
{
  double y,z;
  if ( x< 0.5) {

    z = sqrt(-1);
    
  } else if (x < 1.0) {

    y = (2*x - 1.5)/0.25;
    z = chbevl(y, q_2_A, 30);

  } else if (x < 5.0) {
    
    y = (2*x - 6)/2.0;
    z = chbevl(y, q_2_B, 40);

  } else if (x <= 30.0) {
    
    y = (2*x - 35)/(12.5);
    z = chbevl(y,q_2_C,30);

  } else {

    z = sqrt(-1);

  }

  return z;
}
