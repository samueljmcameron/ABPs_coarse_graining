#include <math.h>
#include "chbevl.h"

/* Starting with
 *	 q_1(x) = int_{0.5}^x K_1(u)/u^12 du
 * function. */

/* coeffs for q_1(x) with 0.5 < x < 1.0 */
static double q_1_A[] = 
  {
    -9.450773497121645e-14,
    -6.763617443894532e-14,
    2.321476344491202e-14,
    2.031028123461454e-13,
    2.364858309178430e-13,
    6.681877273706505e-14,
    -2.161104628584098e-13,
    8.592848654842556e-14,
    9.026390745958679e-14,
    -6.486255976767552e-13,
    1.616495826084474e-12,
    -6.991668355382785e-12,
    3.021742855935372e-11,
    -1.248413705745577e-10,
    5.129882574284039e-10,
    -2.084313610595245e-09,
    8.362436682007868e-09,
    -3.311289508700632e-08,
    1.292709820799320e-07,
    -4.970275269466917e-07,
    1.879792141246117e-06,
    -6.983906314372845e-06,
    2.544951430660802e-05,
    -9.080215758906496e-05,
    3.165808571577333e-04,
    -1.076101818471531e-03,
    3.556776508822990e-03,
    -1.139622515879338e-02,
    3.526981305834677e-02,
    -1.049865889273773e-01,
    2.990513601653371e-01,
    -8.101730718417027e-01,
    2.071984665594528e+00,
    -4.956489125452586e+00,
    1.096369481078073e+01,
    -2.210346922172920e+01,
    3.987898441818925e+01,
    -6.292651670935213e+01,
    8.447138443082922e+01,
    4.572769513723391e+02,
  };
/* coeffs for q_1(x) with 1.0 < x < 5.0 */
static double q_1_B[] = 
  {
    9.016625829810271e-13,
    -2.436838609686343e-12,
    6.485801794621114e-12,
    -1.359009874332432e-11,
    2.888485410453127e-11,
    -6.002665031701326e-11,
    1.228050388652429e-10,
    -2.499430965227393e-10,
    5.063534238367786e-10,
    -1.019214773185178e-09,
    2.041460980060285e-09,
    -4.060337682238407e-09,
    8.019831909678032e-09,
    -1.572592948791267e-08,
    3.060193100943500e-08,
    -5.907388097884078e-08,
    1.130737930762652e-07,
    -2.145098108030652e-07,
    4.031223878345455e-07,
    -7.500545264478702e-07,
    1.380894812799935e-06,
    -2.513985307928124e-06,
    4.522708866003003e-06,
    -8.034173836273856e-06,
    1.408102282079488e-05,
    -2.432703304707088e-05,
    4.138874234110352e-05,
    -6.927086433253490e-05,
    1.139170242975173e-04,
    -1.838416664412534e-04,
    2.907458549789122e-04,
    -4.499248438595383e-04,
    6.801556466536402e-04,
    -1.002637432724834e-03,
    1.438507935220783e-03,
    -2.004571373501821e-03,
    2.707257145283909e-03,
    -3.535547520228151e-03,
    4.454585829718512e-03,
    -5.402576419046764e-03,
    6.293825841313802e-03,
    -7.029704855956321e-03,
    7.516696759557301e-03,
    5.509836245296137e+02,
  };
/* coeffs for q_1(x) with 5.0 < x < 30.0 */
static double q_1_C[] = 
  {
    -2.436838609686344e-13,
    5.711794673598806e-13,
    -1.454997738454205e-13,
    3.872457909892546e-13,
    -1.585802196628223e-13,
    -4.150215524780585e-13,
    2.557953848736361e-13,
    -2.861549381288404e-13,
    2.532115931072357e-13,
    5.755396159656812e-13,
    -1.362950156776192e-13,
    1.356490677360191e-14,
    9.560029535681348e-14,
    6.330289827680892e-14,
    -1.860330071808262e-13,
    -2.390007383920337e-13,
    2.712981354720382e-13,
    1.847411112976260e-13,
    1.705302565824240e-13,
    2.506278013408353e-13,
    2.364169466256333e-13,
    -1.201463171376169e-13,
    -1.989519660128281e-13,
    9.947598300641403e-14,
    2.002438618960282e-13,
    -5.296773121120747e-14,
    -1.963681742464277e-13,
    -1.421085471520200e-13,
    -1.705302565824240e-13,
    2.454602178080346e-14,
    -1.149787336048162e-13,
    -1.847411112976260e-13,
    2.041195495456288e-13,
    -2.687143437056379e-13,
    3.513956802304495e-13,
    -4.780014767840674e-13,
    3.979039320256561e-13,
    -3.720660143616525e-13,
    6.071910651040856e-13,
    -4.108228908576579e-13,
    4.340770167552612e-13,
    -5.400124791776761e-13,
    5.994396898048845e-13,
    5.509913117856062e+02,
  };

double q1(double x)
{
  double y,z;
  if ( x< 0.5) {

    z = sqrt(-1);
    
  } else if (x < 1.0) {

    y = (2*x - 1.5)/0.25;
    z = chbevl(y, q_1_A, 40);

  } else if (x < 5.0) {
    
    y = (2*x - 6)/2.0;
    z = chbevl(y, q_1_B, 44);

  } else if (x <= 30.0) {
    
    y = (2*x - 35)/(12.5);
    z = chbevl(y,q_1_C,44);

  } else {

    z = sqrt(-1);

  }

  return z;
}
