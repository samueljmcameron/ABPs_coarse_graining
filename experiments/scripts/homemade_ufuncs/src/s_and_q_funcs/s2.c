#include <math.h>
#include "chbevl.h"

/* Starting with
 *	 s_2(x) = int_{0.5}^x I_1(u)/u^6 du
 * function. */

/* coeffs for s_2(x) with 0.5 < x < 1.0 */
static double s_2_A[] = 
  {
    -7.039531098417579e-16,
    1.199522562131802e-15,
    -3.543792243781191e-17,
    -1.733670251009250e-15,
    6.326242233440598e-15,
    -3.346609943531500e-14,
    1.726381004917605e-13,
    -8.817944204680961e-13,
    4.473292148405544e-12,
    -2.254277320368203e-11,
    1.127557213335069e-10,
    -5.593883032875161e-10,
    2.749907140105895e-09,
    -1.338048218150984e-08,
    6.435829068737592e-08,
    -3.055122169877461e-07,
    1.428580320958321e-06,
    -6.564374791855673e-06,
    2.955194809483094e-05,
    -1.298383894986404e-04,
    5.539082983822655e-04,
    -2.278820807468647e-03,
    8.954764539286623e-03,
    -3.314262777160297e-02,
    1.130578185229537e-01,
    -3.427942750239936e-01,
    8.626902487413057e-01,
    2.727280467397703e+00,
  };
/* coeffs for s_2(x) with 1.0 < x < 5.0 */
static double s_2_B[] = 
  {
    5.992428775414283e-15,
    -1.580402475553910e-14,
    3.612388166374103e-14,
    -8.512635041313388e-14,
    2.115030373062154e-13,
    -5.092926080862981e-13,
    1.226185819547254e-12,
    -2.951372479742531e-12,
    7.080008801452209e-12,
    -1.694992479706059e-11,
    4.043517187746204e-11,
    -9.620588214964699e-11,
    2.281775712820178e-10,
    -5.393733459868600e-10,
    1.270440574963061e-09,
    -2.980951607778337e-09,
    6.965707943784594e-09,
    -1.620494564091857e-08,
    3.751853848710240e-08,
    -8.641427097222376e-08,
    1.979103506855040e-07,
    -4.504747120326336e-07,
    1.018438220190543e-06,
    -2.285422980952134e-06,
    5.086572911838782e-06,
    -1.121795729617237e-05,
    2.448872619142950e-05,
    -5.284829087157661e-05,
    1.125767889559870e-04,
    -2.362782684788956e-04,
    4.875090979180596e-04,
    -9.860993515190320e-04,
    1.948600661304944e-03,
    -3.744995541051621e-03,
    6.959629619675367e-03,
    -1.240886831348794e-02,
    2.101514471886355e-02,
    -3.322930611967238e-02,
    4.932800004585922e-02,
    4.202260660640677e+00,
  };
/* coeffs for s_2(x) with 5.0 < x < 20.0 */
static double s_2_C[] = 
  {
    1.801336857454317e-15,
    -6.500355809180291e-15,
    1.986188991054405e-14,
    -4.729550084903167e-14,
    1.241451386135850e-13,
    -3.288924688149564e-13,
    9.111822407703586e-13,
    -2.332452749461330e-12,
    7.208433849825724e-12,
    -1.282137359244947e-11,
    7.796570796377485e-11,
    7.354289029611512e-11,
    1.535423314417509e-09,
    6.118329975990378e-09,
    4.088098378337198e-08,
    1.961504287587938e-07,
    1.017347534067644e-06,
    4.639476696880844e-06,
    2.063256307910007e-05,
    8.390325301933880e-05,
    3.215494468263191e-04,
    1.128597551112653e-03,
    3.656801185631098e-03,
    1.072065549051500e-02,
    2.839152680618169e-02,
    6.647243841700615e-02,
    1.364237608245026e-01,
    2.377310620000491e-01,
    3.479277243135456e-01,
    4.661883458821776e+00,
  };
/* coeffs for s_2(x) with 20.0 < x < 25.0 */
static double s_2_D[] = 
  {
    -1.183775300006573e-14,
    1.423464520858683e-15,
    -4.908771801735514e-15,
    -6.923033574984012e-15,
    7.612957883143930e-16,
    -2.474211312021777e-15,
    -7.216449660063518e-15,
    -7.406773607142115e-15,
    2.030122102171715e-15,
    -4.250568151422028e-15,
    2.304505792543361e-14,
    3.765242086371602e-13,
    5.792192122758674e-12,
    8.373581193511979e-11,
    1.138490222731191e-09,
    1.447738062765325e-08,
    1.712712740837524e-07,
    1.873399801288755e-06,
    1.880810084228405e-05,
    1.717847418288049e-04,
    1.411949003331938e-03,
    1.030123985030792e-02,
    6.553463925001604e-02,
    3.549559840220018e-01,
    1.582496064225919e+00,
    5.519436680594781e+00,
    1.384590772975549e+01,
    2.554865613699389e+01,
  };
/* coeffs for s_2(x) with 25.0 < x < 30.0 */
static double s_2_E[] = 
  {
    -6.257375570076614e-13,
    -2.104982854689297e-13,
    -3.861038473067830e-13,
    -3.236775926650028e-13,
    -1.121642461449872e-13,
    -2.037735060054859e-13,
    -4.151599698941157e-13,
    -4.793625813752961e-13,
    -1.068351756267865e-13,
    -7.739840514529662e-14,
    1.687031466904695e-12,
    2.645756629655287e-11,
    3.980315759528301e-10,
    5.640651628319964e-09,
    7.501933550559312e-08,
    9.317976759705613e-07,
    1.075012028982160e-05,
    1.144690652054184e-04,
    1.116530241115703e-03,
    9.885726649143476e-03,
    7.856792826250368e-02,
    5.526813885988501e-01,
    3.379137693853891e+00,
    1.752572532542244e+01,
    7.452318543952670e+01,
    2.469660074728758e+02,
    5.876242804517736e+02,
    8.694128971150783e+02,
  };

double s2(double x)
{
  double y,z;
  if ( x< 0.5) {

    z = sqrt(-1);
    
  } else if (x < 1.0) {

    y = (2*x - 1.5)/0.25;
    z = chbevl(y, s_2_A, 28);

  } else if (x < 5.0) {
    
    y = (2*x - 6)/2.0;
    z = chbevl(y, s_2_B, 40);

  } else if (x < 20.0) {
    
    y = (2*x - 25)/(7.5);
    z = chbevl(y,s_2_C,30);

  } else if (x < 25.0) {
    
    y = (2*x - 45)/(2.5);
    z = chbevl(y,s_2_D,28);

  } else if (x <= 30.0) {
    
    y = (2*x - 55)/(2.5);
    z = chbevl(y,s_2_E,28);

  } else {

    z = sqrt(-1);

  }

  return z;
}
